<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
  <!--  <link rel="icon" href="../../../../favicon.ico">-->

    <title>Dashboard for students</title>

    <!-- Bootstrap core CSS -->
    <link href="../../stylesheets/bootstrap.min.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <!-- Custom styles for this template -->
    <link href="../../stylesheets/dashboard.css" rel="stylesheet">
    <link rel="stylesheet" href="../../stylesheets/style.css">
    <link rel="stylesheet" href="../../stylesheets/hangsuper.css" />
  </head>

  <body>
    <nav class="navbar navbar-expand-md navbar-dark fixed-top" style="background-color: #114a81;">
      <a class="navbar-brand" href="#">UPMS</a>
      <div class="collapse navbar-collapse" id="navbarsExampleDefault">

          <div class="project-name">
            <a href="../">University Project Management System</a>
          </div>
          <div class="welcome">
            Welcome:
            <span id = "userId"> </span>
            <span id = "logout"class="btn">sign out</span>
          </div>
      </div>
    </nav>


    <div class="container-fluid">
      <div class="row">
       <nav class="col-sm-3 col-md-2 d-none d-sm-block sidebar" style="background-color: #666666;">
          <ul class="nav nav-pills flex-column">
            <li class="nav-item">
              <a class="nav-link" href="/student">Dashboard</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="/student/project">Projects</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/student/group">Groups</a>

            </li>

            <li class="nav-item">
              <a class="nav-link" href="/student/assessment">Assessment</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/student/self_reflection">Self-reflection</a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="/student/manage_meeting_time">Register meeting Time</a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="/student/manage_presentation_time"> Register presentation Time</a>
            </li>
          </ul>
          <hr>

          <ul class="nav nav-pills flex-column">

            <li class="nav-item">
              <a class="nav-link" href="#">Contact</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/student/profile">Profile</a>
            </li>
          </ul>

        </nav>

        <main class="col-sm-9 ml-sm-auto col-md-10 pt-3" role="main">



              <div class="panel">
                 <div class="panel-title">
                <span>Project Details</span>


              </div>
              <div class="panel-body-all">
                <div class="panel-body">
                  <div class="panel-body-t link">
                  <%= projectName %>
<input type="file" style="width: 58%;border-radius: 4px;padding: 5px;border: 1px solid #114a81">
<button style="background-color: #4a86e8; border: 1px solid #4a86e8;border-radius: 8px; margin-top: 10px; color: #fff; cursor: pointer;">upload</button>
                  </div>




                  <div class="panel-body-t-score"><br>
                  </div>
                  <div class="panel-body-b">
   <iframe id='iframe' src= '/coord/project_detail/projectUploads/<%= filePath %>' onload='readfile()'> </iframe>

                  </div>

                </div>

              </div>
            </div>


        </main>

      </div>
    </div>



    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script>window.jQuery || document.write('<script src="../../../../assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="../../../javascripts/hangsuper.js"></script>
    <script src="../../../javascripts/signin.js"></script>
  </body>
</html>

<script>
console.log(<%= projectId %>);
console.log(document.getElementsByTagName("button")[0]);
console.log(document.getElementsByTagName("button").length);

function readfile() {
     document.getElementById('iframe').contentDocument.body.firstChild.innerHTML;
}

hs.click(hs.getTagName('button')[0],function(){
  var username = localStorage.getItem('userId');
  var project_id = <%= projectId %>;
  var url = '/student/upload_project/uploadFile';
  hs.uploadFile(hs.getTagName('input')[0].files[0],url,function(res){
    if (res === "not pdf"){
      hs.toast("red",2,"Please select a PDF file");
    }else if (res === "name error"){
      hs.toast("red",2,"Upload file fail");
    }else{
      hs.postAjax({
        url:'/student/upload_project/uploadApplication',
        data:{
          fileName:res,
          student: username,
          projectName: project_id
        },
        succFn:function(res){
          if (res == 2 ){
            hs.toast('green',2,'Upload Complete');
            setTimeout(function(){
              hs.redirect('/student/project');
            }, 1500);
          }else{
            hs.toast("red",2,"upload application error");
          }
        }
      })
    }


  })
})

</script>
