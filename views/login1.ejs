<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <title>UPMS</title>
  
  <link href="../stylesheets/bootstrap.min.css" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <link href="../stylesheets/dashboard.css" rel="stylesheet">
  <link rel="stylesheet" href="../stylesheets/style.css" />
  <link rel="stylesheet" href="../stylesheets/hangsuper.css" />
  <script src="../javascripts/hangsuper.js"></script>
  <style type="text/css">
    body{
      background-color: #f0f0f0;
    }
    .login-panel{
      margin:50px auto;
      width:40%;
      height:auto;
      padding:20px;
      border-radius: 8px;
    box-shadow: 5px 5px 5px #C8C8C8;
    background-color: #fff;
    }
    .login-panel-title{
      text-align: center;
      background-color: #165E9C;
      height:44px;
      width:auto;
      color:#fff;
      line-height: 44px;
      font-size: 18px;
      margin-bottom: 40px;
    }
    .login-panel-t{
      height: auto;
      width:80%;
      margin: 20px auto;
    }
    .login-panel-t input{
      width:100%;
      margin-top: 30px;
      height: 44px;
      font-size: 18px;
      padding:5px;
      border:2px solid #165E9C;
    }
    .login-panel-m{
      margin:20px auto;
      width: 80%;
      height: auto;
    }
    .login-panel-m button{
    text-align: center;
    background-color: #165E9C;
    line-height: 44px;
    font-size: 18px;
    width:100%;
    color:#fff;
    margin-top:20px;
    margin-bottom: 10px;
    border:0;
    cursor: pointer;
    }

  </style>
</head>
<body>
   <nav class="navbar navbar-expand-md navbar-dark fixed-top" style="background-color: #114a81;">
      <a class="navbar-brand" href="#">UPMS</a>
      <div class="collapse navbar-collapse" id="navbarsExampleDefault">
       
          <div class="project-name">
            <a href="#">University Project Management System</a>
          </div>
      </div>
    </nav>
    <div class="content" style="margin-top: 100px;">
       <div class="login-panel">
    <div class="login-panel-title">
      LOGIN TO UPMS
    </div>
    <div class="login-panel-t">
      <input class= "textIput" type="text" name="username" placeholder="Username" style="margin-top:-30px;">
      <span class="error">Please enter a valid username</span>
      <input class= "textIput" type="password" name="username" placeholder="Password"  onkeypress="hs.keyPress(event,enterCallback);">
      <span class="error">Please enter a valid password</span>
  </div>
    <div class="login-panel-m">
      <button name="submit">LogIn</button>
    </div>
    <div class="login-panel-b">
      <div class="login-panel-b-l">
        <span class="link">Forgot your password?</span>
      </div>
      <div class="login-panel-b-r"></div>
    </div>
  </div>
      <button>student</button>
      <button>tutor</button>
      <button>coordinator</button>
      <button>superviser</button>
    </div>

  <script>

    
    var btn = hs.getTagName("button");
    var page = ["student","tutor","coord","superviser"];
    


    function login(){
      var inputs = hs.getTagName('input');
      var err = hs.getClassName('error');
      err[0].style.display="none";
      err[1].style.display="none";
      
      if (hs.isEmpty(inputs[0].value)){
        err[0].style.display = "block";
        return;
      }else if(hs.isEmpty(inputs[1].value)){
        err[1].style.display = "block";
        return;
      } else {
          hs.postAjax({
          url:'/portalLogin',
          data:{
            username:inputs[0].value,
            password:inputs[1].value
          },
          succFn:function(res){
            if (res === "Wrong username"){
              hs.toast('red',2,"Please insert a valid username");
            }else if(res === "fail"){
              hs.toast('red',2,"Wrong username or password");
            } else{
              var userArr = [];
              userArr = JSON.parse(res);

              localStorage.setItem('userId',inputs[0].value);
              localStorage.setItem('username', userArr[1]+' '+userArr[2]);
              hs.toast('green',2,'Logging in....');
              setTimeout( () => {
                hs.redirect(userArr[0]);
              }, 2000);
              
            }
          }
        })
      }
    }

    btn[0].addEventListener('click',function(){
        login();
    });


    function enterCallback(){
      login();
    }
    // btn[1].addEventListener('click',function(){
    //   hs.redirect(page[1]);
    // });
    // btn[2].addEventListener('click',function(){
    //   hs.redirect(page[2]);
    // });
    // btn[3].addEventListener('click',function(){
    //   hs.redirect(page[3]);
    // });


  </script>
</body>
</html>